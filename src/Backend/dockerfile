FROM python:alpine

ENV PYTHONUNBUFFERED 1
ENV PYTHONDONTWRITEBYTECODE 1

COPY . /app

WORKDIR /app/source

RUN pip install --upgrade pip \
    && pip install --no-cache-dir -r requirements.txt \
    && chmod -R +x /app 
    # && apk update \
    # && apk add --no-cache \
    # curl \
    # wget


# RUN mkdir -p /app/staticfiles/
# RUN apt update && apt install wget -y
# RUN wget https://github.com/prometheus/node_exporter/releases/download/v1.1.1/node_exporter-1.1.1.linux-amd64.tar.gz

# RUN tar xvfz node_exporter-*.*-amd64.tar.gz
# RUN ./node_exporter & in the background
# curl http://backend:9100/metrics for metrics

EXPOSE 8080

ENTRYPOINT [ "sh", "../config/autoDeploy.sh" ]
CMD ["daphne", "-b", "0.0.0.0", "-p", "8080", "_1Config.asgi:application"]
